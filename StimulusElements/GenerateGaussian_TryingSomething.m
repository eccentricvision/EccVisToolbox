function gaussian = GenerateGaussian_TryingSomething(xsize,ysize,sigmaX,sigmaY,theta,xoff,yoff)%generates a 2D gaussian with a given patch size, sd, orientation (in radians where -45 is top right) and offset% input xsize, ysize, sigmaX, sigmaY, theta, xoff and yoff% eg1: gaussian = GenerateGaussian_TryingSomething(256,256,32,32,pi/2,0,0); ishow(gaussian)% eg2: gaussian = GenerateGaussian_TryingSomething(256,256,12,32,deg2rad(-45),0,0); ishow(gaussian)%J Greenwood 2009, modified 2012[X,Y]=meshgrid(-xsize/2:xsize/2-1,-ysize/2:ysize/2-1);X  = X-xoff;Y  = Y-yoff;% speedy variablesc1=cos(pi-theta);s1=sin(pi-theta);sigX_squared=2*sigmaX*sigmaX;sigY_squared=2*sigmaY*sigmaY;% rotate co-ordinatesXt = X.*c1 + Y.*s1;Yt = Y.*c1 - X.*s1;gaussian = exp(-((Xt.*Xt)/sigX_squared)-((Yt.*Yt)/sigY_squared));